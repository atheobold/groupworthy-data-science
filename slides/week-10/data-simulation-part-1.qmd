---
title: "Simulating Data in R"
format: 
  revealjs:
      theme: [simple, ../style.scss]
      auto-stretch: false
editor: source
execute:
  echo: true
---

```{r setup}
#| include: false
#| message: false
library(tidyverse)
```

## Today we will...

+ Plan for Week 9 & 10
+ Survey on Group Collaborations
+ New Material
  + Statistical Distributions
  + Simulating Data
+ PA 9: Instrument Con

# Week 9 

. . .

- PA 10 (today)
- Lab 10 (last one!)
- Revisions on Lab 8 (due Friday) 

# Week 10

. . .

- Revisions on Lab 9 (due Monday)
- Final Portfolio Week!

. . .

::: {.callout-warning}

No revisions will be accepted on Lab 10. You can, however, talk with me
during class about any questions you have. :) 
:::

# Researching Survey Design

## 

::: {style="font-size: 3em; color: #ed8402;"}
5-minutes
:::

:::::: columns
::: {.column width="47%"}
If you [would]{.underline} like to participate

-   Complete [consent form](https://forms.office.com/r/TckhG81y7q) (say yes)
:::

::: {.column width="5%"}
:::

::: {.column width="47%"}
If you [would not]{.underline} like to participate

-   Complete [consent form](https://forms.office.com/r/TckhG81y7q) (say no)
:::
::::::

# Statistical Distributions

## Statistical Distributions

Recall from your statistics classes...

::: panel-tabset

### Random Variable

A **random variable** is a value we don't know until we take a **sample**.

+ Coin flip:  could be heads (0) or tails (1)
+ Person's height:  could be anything from 0 feet to 10 feet.
+ Annual income of a US worker:  could be anything from $0 to $1.6 billion

### Distribution

The **distribution** of a random variable tells us its **possible values** and
**how likely they are to occur**.

:::: {.columns}
::: {.column width=73%}
+ Coin flip: 50% chance of heads and tails.
+ Heights follow a bell curve centered at 5 foot 7.
+ Most American workers make under $100,000.
:::
::: {.column width=27%}
![](images/dist.png){fig-alt="A picture of a histogram (with blue bars) that a smiling face has been superimposed on top of. The smiling face also has arms extending upward above the histogram bars."}
:::
::::
:::


## Statistical Distributions with Names!

::: panel-tabset

### `unif`

**Uniform Distribution**

:::: columns
::: column
+ When you know the **range** of values, but not much else.
+ All values in the range are **equally likely** to occur.
:::
::: column
```{r}
#| out-width: 100%
#| echo: false
my_samples <- data.frame(x = runif(1000))

ggplot(my_samples, aes(x)) + 
  geom_histogram(bins = 40, aes(y = ..density..), fill = "grey", col = "white") + 
  stat_function(fun=dunif, col = "cornflowerblue", lwd = 2) +
  theme_classic()
```
:::
::::
### `norm`

**Normal Distribution**

:::: columns
::: column
+ When you expect most values to fall **near the center**.
+ Frequency of values follows a **bell shaped curve**.
:::
::: column
```{r}
#| out-width: 100%
#| echo: false
my_samples <- data.frame(x = rnorm(1000))

ggplot(my_samples, aes(x)) + 
  geom_histogram(bins = 40, aes(y = ..density..), fill = "grey", col = "white") + 
  stat_function(fun=dnorm, col = "cornflowerblue", lwd = 2) +
  theme_classic()
```
:::
::::
### `t`

**t-Distribution**

:::: columns
::: column
+ A slightly **wider** bell curve.
+ Basically used in the same context as the **Normal distribution**, but more common with  real data (when the *standard deviation* is unknown).
:::
::: column
```{r}
#| out-width: 100%
#| echo: false

ggplot(my_samples, aes(x)) + 
  geom_histogram(bins = 40, aes(y = ..density..), fill = "grey", col = "white") + 
  stat_function(fun= function(x) dt(x, df = 5), col = "cornflowerblue", lwd = 2) +
  stat_function(fun = dnorm, col = "indianred", lwd = 1) +
  theme_classic()
```
:::
::::
### `chisq`

**Chi-Square Distribution**

:::: columns
::: column
+ Somewhat **skewed**, and only allows values **above zero**.
+ Used in testing **count data**.
:::
::: column
```{r}
#| out-width: 100%
#| echo: false
my_samples <- data.frame(x = rchisq(1000, df = 5))

ggplot(my_samples, aes(x)) + 
  geom_histogram(bins = 40, aes(y = ..density..), fill = "grey", col = "white") + 
  stat_function(fun= function(x) dchisq(x, df = 5), col = "cornflowerblue", lwd = 2) +
  theme_classic()
```
:::
::::

### `binom`

**Binomial Distribution**

:::: columns
::: column
::: {.midi}
+ Appears when you have **two possible outcomes**, and you are **counting** how many times each outcome occurred.
+ This is a *discrete* distribution, as there can only be whole number values!
:::
:::
::: column
```{r}
#| out-width: 100%
#| echo: false
my_samples <- data.frame(x = rbinom(1000, 10, .8))

ggplot(my_samples, aes(x)) + 
  geom_bar(fill = "grey", col = "white") + 
  theme_classic()
```
:::
::::
:::

## Distribution Functions in R

::: panel-tabset
### `r`

`r` is for **random sampling**.

::: {.midi}
+ Generate random values from a distribution.
+ We use this to **simulate** data (create pretend observations).
:::

:::: columns
::: column
::: {.fragment}
::: {.midi}
```{r}
#| code-line-numbers: false

runif(n = 3, 
      min = 10, 
      max = 20)
rnorm(n = 3, 
      mean = 5, 
      sd = 2)
```
:::
:::
:::
::: column
::: {.fragment}
::: {.midi}
```{r}
#| code-line-numbers: false

rt(n = 3, 
   df = 11)
rbinom(n = 3, 
       size = 10, 
       prob = 0.7)
```
:::
:::
:::
::::

### `p`

`p` is for **probability**.

::: {.midi}
+ Compute the chances of observing a value less than (or greater than) `x`.
:::

:::: {.columns}
::: {.column width=45%}
::: {.fragment}
::: {.midi}
```{r}
#| code-line-numbers: false

pchisq(q = 2, 
      df = 8)
```
:::
:::
:::

::: {.column width=55%}
::: {.fragment}
::: {.midi}
```{r}
#| code-line-numbers: false

pchisq(q = 2, 
      df = 8, 
      lower.tail = FALSE)

1 - pchisq(q = 2, 
      df = 8)
```
:::
:::
:::
::::

### `q`

`q` is for **quantile**.

::: {.midi}
+ Given a probability $p$, compute $x$ such that $P(X < x) = p$.
+ The `q` functions are "backwards" of the `p` functions.
:::

::: {.fragment}
::: {.midi}
::: columns
::: {.column width="40%"}
```{r}
#| code-line-numbers: false

qt(p = 0.95,
   df = 12)
```
:::

::: {.column width="5%"}
:::

::: {.column width="55%"}
```{r}
#| code-line-numbers: false

qt(p = 0.95,
   df = 30)
```
:::
:::
:::
:::

### `d`

`d` is for **density**.

::: {.midi}
+ Compute the *height* of a distribution curve at a given $x$.
+ For **discrete** dist: probability of getting **exactly** $x$.
+ For **continuous** dist: usually meaningless.
:::

::: {.fragment}
::: {.midi}
Probability of *exactly* 12 heads in 20 coin tosses, with a 50% chance of tails?

```{r}
#| code-line-numbers: false

dbinom(x = 12, size = 20, prob = 0.5)
```
:::
:::
:::

# Simulating Data

## Simulate a Dataset

::: panel-tabset

### The Idea

We can generate fake data based on the assumption that a variable follows a certain distribution.

+ We randomly sample observations from the distribution.

```{r}
#| code-line-numbers: false

age <- runif(n = 1000, 
             min = 15, 
             max = 75)
```


### `set.seed()`

::: {.midi}
Since there is randomness involved, we will get a different result each time we run the code.
:::

:::: {.columns}
::: {.column width=50%}
::: {.midi}
```{r}
#| code-line-numbers: false

runif(n = 3, min = 15, max = 75)
```
:::
:::
::: {.column width=50%}
::: {.midi}
```{r}
#| code-line-numbers: false

runif(n = 3, min = 15, max = 75)
```
:::
:::
::::

</br>

::: {.fragment}
::: {.midi}
To make a **reproducible** random sample, we first **set the seed**:
:::

:::: {.columns}
::: {.column width=50%}
::: {.midi}
```{r}
#| code-line-numbers: false

set.seed(93401)
runif(n = 3, min = 15, max = 75)
```
:::
:::
::: {.column width=50%}
::: {.midi}
```{r}
#| code-line-numbers: false

set.seed(93401)
runif(n = 3, min = 15, max = 75)
```
:::
:::
:::
::::

### `tibble()`

::: {.small}
```{r}
#| code-line-numbers: "4-6" 
set.seed(435)

fake_data <- tibble(names   = charlatan::ch_name(n = 1000),
                    age     = runif(n = 1000, min = 18, max = 29),
                    mamdani = rbinom(n = 1000, size = 1, prob = 0.75)
                    ) |> 
  mutate(supports_mamdani = ifelse(mamdani == 1, "yes", "no"))

head(fake_data)
```
:::

### visualize

Check to see the ages look uniformly distributed.

::: {.small}
```{r}
#| code-fold: true
#| fig-align: center
#| out-width: 60%
fake_data |> 
  ggplot(mapping = aes(x = age,
                       fill = supports_mamdani)) +
  geom_histogram(show.legend = F) +
  facet_wrap(~ supports_mamdani,
             ncol = 1) +
  scale_fill_brewer(palette = "Paired") +
  theme_bw() +
  labs(x = "Age (years)",
       y = "",
       subtitle = "Number of Individuals Supportng Prop 50 for Different Ages",)
```
:::
:::

# PA 9: Instrument Con

> Is the instrument salesman selling fake instruments?

## PA 9

::: {.midi}
In this practice activity you and your partner will write a function to simulate
the weight of various band instruments, with the goal of identifying whether a
particular shipment of instruments has a "reasonable" weight.
:::

. . .

::: columns
::: {.column width="55%"}
::: {.small}
This activity will require knowledge of:

- named distributions 
- probability calculations related to distributions
- function documentation
- function syntax
- function arguments
:::
:::

::: {.column width="5%"}
:::

::: {.column width="40%"}
</br>
</br>

[**None of us have all these abilities. Each of us has some of these abilities.**]{.midi}

:::
:::

## A reminder about boolean values...

Suppose `x` is Normally distributed with mean 5 and standard deviation 2. 

We would expect about `r (pnorm(3, mean = 5, sd = 2) * 100) |> round(digits = 2) |> str_c("%")` 
percent of values to be below 3. Let's see if that is the case!

. . .

</br>

Simulate 1000 values of `x`. 

```{r}
#| code-line-numbers: false

sims <- rnorm(n = 1000, mean = 5, sd = 2)
```

## A reminder about boolean values...

How many values were below 3?

. . .

::: columns
::: {.column width="40%"}
```{r}
#| code-line-numbers: false

sims < 3
```

:::

::: {.column width="5%"}
:::

::: {.column width="55%"}
::: {.fragment}
```{r}
#| code-line-numbers: false

sum(sims < 3)
```
:::

::: {.fragment}
```{r}
#| code-line-numbers: false

sum(sims < 3) / length(sims)
```
:::

::: {.fragment}
```{r}
#| code-line-numbers: false

( sum(sims < 3) / 
    length(sims) ) * 100
```
:::
:::
:::

## Submission

You and your partner together should address the following questions:

> How many simulated shipments had a weight less than or equal to Professor
> Hill's shipment? 

> Do you beleive Professor Hill ordered genuine instruments?

# 5-minute break

## Team Assignments - 9am

::: {.centered}
![](images/section-70-seats.png){width=75%}
:::

::: {.small}
The partner whose birthday is the closest to today starts as the Talker!
:::

## Team Assignments - 12pm

::: {.centered}
![](images/section-71-seats.png){width=75%}
:::

::: {.small}
The partner whose birthday is the closest to today starts as the Talker!
:::

